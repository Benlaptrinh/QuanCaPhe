<div th:fragment="content">
    <h2>Thống kê - báo cáo</h2>
  
    <div th:if="${error}" style="color:red">
      <p th:text="${error}"></p>
    </div>
  
    <form th:action="@{/admin/report}" method="post" th:object="${filter}">
      <div>
        <label>Từ ngày:</label>
        <input type="date" th:field="*{fromDate}" required>
      </div>
      <div>
        <label>Đến ngày:</label>
        <input type="date" th:field="*{toDate}" required>
      </div>
      <button type="submit">Xem</button>
    </form>
  
    <!-- TABLE -->
    <table border="1" cellpadding="8" cellspacing="0" style="width:600px;"
           th:if="${reportData != null and !reportData.isEmpty()}">
      <thead>
        <tr>
          <th>Ngày</th>
          <th>Thu</th>
          <th>Chi</th>
        </tr>
      </thead>
  
      <tbody>
        <tr th:each="row : ${reportData}">
          <td th:text="${#temporals.format(row.ngay,'dd/MM')}"></td>
          <td th:text="${#numbers.formatDecimal(row.thu,0,'COMMA',0,'POINT')}"></td>
          <td th:text="${#numbers.formatDecimal(row.chi,0,'COMMA',0,'POINT')}"></td>
        </tr>
      </tbody>
  
      <tfoot>
        <tr>
          <th>Tổng</th>
          <th th:text="${#numbers.formatDecimal(#aggregates.sum(reportData.![thu]),0,'COMMA',0,'POINT')}"></th>
          <th th:text="${#numbers.formatDecimal(#aggregates.sum(reportData.![chi]),0,'COMMA',0,'POINT')}"></th>
        </tr>
      </tfoot>
    </table>
  
    <p th:if="${reportData == null or reportData.isEmpty()}">
      Chưa có dữ liệu
    </p>

    <!-- SALES BY DAY -->
    <h3 style="margin-top:24px;">Bán hàng theo ngày</h3>
    <table border="1" cellpadding="8" cellspacing="0" style="width:600px;"
           th:if="${salesByDay != null and !salesByDay.isEmpty()}">
      <thead>
        <tr>
          <th>Ngày</th>
          <th>Số hóa đơn</th>
          <th>Doanh thu</th>
        </tr>
      </thead>
      <tbody>
        <tr th:each="r : ${salesByDay}">
          <td th:text="${#temporals.format(r.ngay,'dd/MM')}"></td>
          <td th:text="${r.soHoaDon}"></td>
          <td th:text="${#numbers.formatDecimal(r.doanhThu,0,'COMMA',0,'POINT')}"></td>
        </tr>
      </tbody>
      <tfoot>
        <tr>
          <th>Tổng</th>
          <th th:text="${#aggregates.sum(salesByDay.![soHoaDon])}"></th>
          <th th:text="${#numbers.formatDecimal(#aggregates.sum(salesByDay.![doanhThu]),0,'COMMA',0,'POINT')}"></th>
        </tr>
      </tfoot>
    </table>


    <!-- STAFF REPORT -->
    <h3 style="margin-top:24px;">Báo cáo nhân viên</h3>
    <table border="1" cellpadding="8" cellspacing="0" style="width:400px;"
           th:if="${staffReport != null and !staffReport.isEmpty()}">
      <thead>
        <tr>
          <th>Trạng thái</th>
          <th>Số lượng</th>
        </tr>
      </thead>
      <tbody>
        <tr th:each="r : ${staffReport}">
          <td th:text="${r.trangThai}"></td>
          <td th:text="${r.soLuong}"></td>
        </tr>
      </tbody>
    </table>

    <p th:if="${staffReport == null or staffReport.isEmpty()}">
      Chưa có dữ liệu nhân viên
    </p>
  </div>
  